import{a as ge,g as me,r as n,u as be,_ as we,b as T,j as e,s as O,c as ve,d as y,e as ye,y as E,f as J,h as V,i as Z,B as i,n as H,T as r}from"./index-fCfVdIb_.js";import{r as G}from"./createSvgIcon-DwuZuMzk.js";import{c as te,D as je,C as Se}from"./AdminSidebar-BBv4d0ET.js";import{f as W}from"./session-BuX4dWJT.js";import{P as se}from"./Paper-CKbGO1De.js";import{S as Ce}from"./SwitchBase-D6mSDcfl.js";import{B as C}from"./Button-ByqV_kVW.js";import{D as ae,a as re,b as oe,c as ie}from"./DialogTitle-iJWlEKpy.js";import{T as I}from"./TextField-wsB3RUt6.js";import"./createSvgIcon-BSKynw4V.js";import"./useControlled-2dS18CDz.js";import"./Menu-Bci3i90i.js";import"./resolveComponentProps-D3En-UR9.js";import"./HomeOutlined-Pe4WBg8G.js";import"./IconButton-BPkErCXm.js";import"./Divider-Bxrz04ol.js";import"./useSlot-DvK8vWAK.js";function ke(t){return me("MuiSwitch",t)}const c=ge("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Pe=["className","color","edge","size","sx"],ze=t=>{const{classes:s,edge:o,size:x,color:j,checked:d,disabled:w}=t,S={root:["root",o&&`edge${y(o)}`,`size${y(x)}`],switchBase:["switchBase",`color${y(j)}`,d&&"checked",w&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},h=ye(S,ke,s);return T({},s,h)},$e=O("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.root,o.edge&&s[`edge${y(o.edge)}`],s[`size${y(o.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${c.thumb}`]:{width:16,height:16},[`& .${c.switchBase}`]:{padding:4,[`&.${c.checked}`]:{transform:"translateX(16px)"}}}}]}),Re=O(Ce,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,s)=>{const{ownerState:o}=t;return[s.switchBase,{[`& .${c.input}`]:s.input},o.color!=="default"&&s[`color${y(o.color)}`]]}})(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${c.checked}`]:{transform:"translateX(20px)"},[`&.${c.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${c.checked} + .${c.track}`]:{opacity:.5},[`&.${c.disabled} + .${c.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${c.input}`]:{left:"-100%",width:"300%"}}),({theme:t})=>({"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:E.alpha(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(([,s])=>s.main&&s.light).map(([s])=>({props:{color:s},style:{[`&.${c.checked}`]:{color:(t.vars||t).palette[s].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[s].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:E.alpha(t.palette[s].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${c.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${s}DisabledColor`]:`${t.palette.mode==="light"?E.lighten(t.palette[s].main,.62):E.darken(t.palette[s].main,.55)}`}},[`&.${c.checked} + .${c.track}`]:{backgroundColor:(t.vars||t).palette[s].main}}}))]})),Ae=O("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(t,s)=>s.track})(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`})),De=O("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(t,s)=>s.thumb})(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Ne=n.forwardRef(function(s,o){const x=be({props:s,name:"MuiSwitch"}),{className:j,color:d="primary",edge:w=!1,size:S="medium",sx:h}=x,$=we(x,Pe),p=T({},x,{color:d,edge:w,size:S}),l=ze(p),g=e.jsx(De,{className:l.thumb,ownerState:p});return e.jsxs($e,{className:ve(l.root,j),sx:h,ownerState:p,children:[e.jsx(Re,T({type:"checkbox",icon:g,checkedIcon:g,ref:o,ownerState:p},$,{classes:T({},l,{root:l.switchBase})})),e.jsx(Ae,{className:l.track,ownerState:p})]})});var k={},ne;function Ee(){if(ne)return k;ne=1;var t=J();Object.defineProperty(k,"__esModule",{value:!0}),k.default=void 0;var s=t(G()),o=V();return k.default=(0,s.default)((0,o.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6m0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20"}),"AccountCircle"),k}var We=Ee();const Ie=Z(We);var P={},le;function Te(){if(le)return P;le=1;var t=J();Object.defineProperty(P,"__esModule",{value:!0}),P.default=void 0;var s=t(G()),o=V();return P.default=(0,s.default)((0,o.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2m6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5z"}),"NotificationsNone"),P}var Oe=Te();const _e=Z(Oe);var z={},ce;function Me(){if(ce)return z;ce=1;var t=J();Object.defineProperty(z,"__esModule",{value:!0}),z.default=void 0;var s=t(G()),o=V();return z.default=(0,s.default)([(0,o.jsx)("path",{d:"m21 5-9-4-9 4v6c0 5.55 3.84 10.74 9 12 2.3-.56 4.33-1.9 5.88-3.71l-3.12-3.12c-1.94 1.29-4.58 1.07-6.29-.64-1.95-1.95-1.95-5.12 0-7.07 1.95-1.95 5.12-1.95 7.07 0 1.71 1.71 1.92 4.35.64 6.29l2.9 2.9C20.29 15.69 21 13.38 21 11z"},"0"),(0,o.jsx)("circle",{cx:"12",cy:"12",r:"3"},"1")],"Policy"),z}var qe=Me();const Be=Z(qe),Fe=[{key:"account",icon:e.jsx(Ie,{sx:{fontSize:28}}),title:"Account",subtitle:"Settings related to your personal information and account credentials"},{key:"notifications",icon:e.jsx(_e,{sx:{fontSize:28}}),title:"Notifications",subtitle:"All settings related to notifications"},{key:"privacy",icon:e.jsx(Be,{sx:{fontSize:28}}),title:"Privacy policy",subtitle:"All settings related to notifications"}],de=[{label:"Pause notification",key:"pause"},{label:"In app",key:"inapp"},{label:"Email",key:"email"},{label:"SMS",key:"sms"},{label:"WhatsApp",key:"whatsapp"}],it=()=>{const t=JSON.parse(localStorage.getItem("user")||"{}"),[s,o]=n.useState("account"),[x,j]=n.useState({pause:!1,inapp:!0,email:!0,sms:!0,whatsapp:!0}),[d,w]=n.useState(null),[S,h]=n.useState(!1),[$,p]=n.useState(""),[l,g]=n.useState(null),[_,M]=n.useState(""),[q,X]=n.useState(!1),[ue,R]=n.useState(!1),[v,K]=n.useState(!1),[Q,m]=n.useState(""),[Y,A]=n.useState(""),[D,B]=n.useState(""),[b,F]=n.useState(""),[N,U]=n.useState(""),[pe,ee]=n.useState(!1);n.useEffect(()=>{if(s!=="account")return;h(!0),p(""),W("http://localhost:3000/api/users/me").then(async u=>{if(!u.ok)throw new Error("Failed to fetch profile");const f=await u.json();w(f.data.user)}).catch(()=>p("Failed to load profile")).finally(()=>h(!1))},[s]);const he=(a,u)=>{g(a),M(u||"")},fe=async()=>{if(l){X(!0);try{const a="http://localhost:3000";if(!(await W(`${a}/api/users/me`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[l]:_})})).ok)throw new Error("Failed to update");g(null),M(""),h(!0),p("");const L=await(await W(`${a}/api/users/me`)).json();w(L.data.user)}catch{}finally{X(!1),h(!1)}}},xe=async()=>{if(!D.trim()||!b.trim()||!N.trim()){m("All fields are required");return}if(b!==N){m("New passwords do not match");return}if(b.length<8){m("New password must be at least 8 characters long");return}if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/.test(b)){m("Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character");return}K(!0),m(""),A("");try{const f=await W("http://localhost:3000/api/users/me/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:D.trim(),newPassword:b.trim()})});if(!f.ok){const L=await f.json();throw new Error(L.error||"Failed to change password")}A("Password changed successfully!"),B(""),F(""),U(""),setTimeout(()=>{R(!1),A("")},2e3)}catch(u){m(u instanceof Error?u.message:"Failed to change password")}finally{K(!1)}};return e.jsxs(i,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#f8f9fa"},children:[e.jsx(i,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(te,{userRole:t.role,currentTab:"settings",onSignOut:H})}),e.jsx(je,{open:pe,onClose:()=>ee(!1),PaperProps:{sx:{width:240}},children:e.jsx(te,{userRole:t.role,currentTab:"settings",onSignOut:H,isDrawer:!0})}),e.jsxs(i,{sx:{flex:1,ml:{xs:0,md:"220px"},display:"flex",flexDirection:"column",minHeight:"100vh",bgcolor:"#f8f9fa"},children:[e.jsx(Se,{user:{name:t.name||"User",role:t.role||"Member",avatarUrl:t.avatar||""},onSignOut:H,onToggleSidebar:()=>ee(!0)}),e.jsxs(i,{sx:{flex:1,display:"flex",flexDirection:{xs:"column",md:"row"},minHeight:"calc(100vh - 64px)",bgcolor:"#f8f9fa"},children:[e.jsx(i,{sx:{width:{xs:"100%",md:320},bgcolor:"#fff",borderRight:{xs:"none",md:"1px solid #e0e0e0"},py:4,px:0,display:{xs:"none",md:"flex"},flexDirection:"column",minHeight:"100%"},children:Fe.map(a=>e.jsxs(i,{sx:{display:"flex",alignItems:"flex-start",gap:2,px:4,py:2.5,cursor:"pointer",bgcolor:s===a.key?"#E8ECF2":"transparent",borderRight:s===a.key?"4px solid #2950DA":"4px solid transparent",mb:.5,borderRadius:0,transition:"background 0.2s",minHeight:72},onClick:()=>o(a.key),children:[e.jsx(i,{sx:{color:s===a.key?"#2950DA":"#222",mt:.5},children:a.icon}),e.jsxs(i,{children:[e.jsx(r,{sx:{fontWeight:800,fontSize:19,color:s===a.key?"#2950DA":"#222",mb:.2},children:a.title}),e.jsx(r,{sx:{color:"#6b7280",fontWeight:400,fontSize:14},children:a.subtitle})]})]},a.key))}),e.jsxs(i,{sx:{flex:1,p:{xs:2,md:6},bgcolor:"#f7f8fa",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",minHeight:"100vh"},children:[s==="notifications"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Notifications"}),e.jsx(se,{elevation:0,sx:{width:{xs:"100%",sm:500},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:de.map((a,u)=>e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:u===de.length-1?0:2},children:[e.jsx(r,{sx:{fontWeight:500,fontSize:18,color:"#222"},children:a.label}),e.jsx(Ne,{checked:x[a.key],onChange:()=>j(f=>({...f,[a.key]:!f[a.key]})),color:"success"})]},a.key))})]}),s==="account"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Account"}),e.jsx(se,{elevation:0,sx:{width:{xs:"100%",sm:500},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:S?e.jsx(r,{children:"Loading..."}):$?e.jsx(r,{color:"error",children:$}):e.jsxs(e.Fragment,{children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsxs(i,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Legal name"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:(d==null?void 0:d.name)||"N/A"})]}),e.jsx(r,{sx:{color:"#2950DA",fontWeight:700,fontSize:15,cursor:"pointer"},onClick:()=>he("name",(d==null?void 0:d.name)||""),children:"Edit"})]}),e.jsx(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:e.jsxs(i,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Email address"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:(d==null?void 0:d.email)||"N/A"})]})}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[e.jsxs(i,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Password"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:"••••••••"})]}),e.jsx(C,{variant:"outlined",color:"primary",onClick:()=>{R(!0),m(""),A(""),B(""),F(""),U("")},children:"Change Password"})]})]})}),e.jsxs(ae,{open:!!l,onClose:()=>g(null),children:[e.jsxs(re,{children:["Edit"," ",l==="name"?"Legal name":l==="email"?"Email address":l==="address"?"Address":l==="phone"?"Phone number":"Government ID"]}),e.jsx(oe,{children:e.jsx(I,{autoFocus:!0,margin:"dense",label:l==="name"?"Legal name":l==="email"?"Email address":l==="address"?"Address":l==="phone"?"Phone number":"Government ID",type:"text",fullWidth:!0,value:_,onChange:a=>M(a.target.value)})}),e.jsxs(ie,{children:[e.jsx(C,{onClick:()=>g(null),disabled:q,children:"Cancel"}),e.jsx(C,{onClick:fe,variant:"contained",color:"primary",disabled:q||!_.trim(),children:q?"Saving...":"Save"})]})]})]}),s==="privacy"&&e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:2},children:"Privacy Policy"})]})]})]}),e.jsxs(ae,{open:ue,onClose:()=>R(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(re,{children:"Change Password"}),e.jsxs(oe,{children:[Y?e.jsx(r,{color:"success.main",sx:{mb:2},children:Y}):null,Q?e.jsx(r,{color:"error.main",sx:{mb:2},children:Q}):null,e.jsxs(i,{sx:{bgcolor:"#f8f9fa",p:2,borderRadius:1,mb:2,border:"1px solid #e9ecef"},children:[e.jsx(r,{sx:{fontWeight:600,fontSize:14,color:"#495057",mb:1},children:"Password Requirements:"}),e.jsxs(i,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• Minimum 8 characters"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 uppercase letter (A-Z)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 lowercase letter (a-z)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 number (0-9)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 special character (@$!%*?&)"})]})]}),e.jsxs(i,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(I,{label:"Current Password",type:"password",fullWidth:!0,value:D,onChange:a=>B(a.target.value),disabled:v}),e.jsx(I,{label:"New Password",type:"password",fullWidth:!0,value:b,onChange:a=>F(a.target.value),disabled:v,helperText:"Minimum 8 characters, 1 uppercase, 1 lowercase, 1 number, and 1 special character"}),e.jsx(I,{label:"Confirm New Password",type:"password",fullWidth:!0,value:N,onChange:a=>U(a.target.value),disabled:v})]})]}),e.jsxs(ie,{children:[e.jsx(C,{onClick:()=>R(!1),disabled:v,children:"Cancel"}),e.jsx(C,{variant:"contained",color:"primary",disabled:v||!D.trim()||!b.trim()||!N.trim(),onClick:xe,children:v?"Changing Password...":"Change Password"})]})]})]})};export{it as default};
