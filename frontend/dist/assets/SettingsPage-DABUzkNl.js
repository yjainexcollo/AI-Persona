import{a as $e,g as Ae,r as n,u as Re,_ as Ee,b as B,j as e,s as q,c as We,d as S,e as De,y as F,f as Q,h as ee,i as se,B as o,n as le,T as r,C as Ne}from"./index-CWeEywqT.js";import{A as ce,D as Ie,M as de,a as Me,W as Te}from"./AdminSidebar-C2x2nuER.js";import{r as te}from"./createSvgIcon-Cam1noSb.js";import{f as O}from"./session-Cma3K_fR.js";import{g as _e,u as Fe}from"./workspaceService-CU4ueMZD.js";import{B as v}from"./Button-DHwWXDFU.js";import{P as Y}from"./Paper-sTiXuyWJ.js";import{S as Oe}from"./SwitchBase-DpchkFVh.js";import{D as ue,a as pe,b as he,c as xe}from"./DialogTitle-CTHzxGHz.js";import{T as $,F as fe,a as ge,S as me}from"./TextField-DHD0qB-R.js";import{A as Be}from"./Alert-CngD2xiH.js";import{G as A}from"./Grid-Aw0Y4g4X.js";function qe(s){return Ae("MuiSwitch",s)}const d=$e("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Le=["className","color","edge","size","sx"],Ue=s=>{const{classes:a,edge:i,size:g,color:k,checked:u,disabled:w}=s,C={root:["root",i&&`edge${S(i)}`,`size${S(g)}`],switchBase:["switchBase",`color${S(k)}`,u&&"checked",w&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},x=De(C,qe,a);return B({},a,x)},He=q("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:i}=s;return[a.root,i.edge&&a[`edge${S(i.edge)}`],a[`size${S(i.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${d.thumb}`]:{width:16,height:16},[`& .${d.switchBase}`]:{padding:4,[`&.${d.checked}`]:{transform:"translateX(16px)"}}}}]}),Ge=q(Oe,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(s,a)=>{const{ownerState:i}=s;return[a.switchBase,{[`& .${d.input}`]:a.input},i.color!=="default"&&a[`color${S(i.color)}`]]}})(({theme:s})=>({position:"absolute",top:0,left:0,zIndex:1,color:s.vars?s.vars.palette.Switch.defaultColor:`${s.palette.mode==="light"?s.palette.common.white:s.palette.grey[300]}`,transition:s.transitions.create(["left","transform"],{duration:s.transitions.duration.shortest}),[`&.${d.checked}`]:{transform:"translateX(20px)"},[`&.${d.disabled}`]:{color:s.vars?s.vars.palette.Switch.defaultDisabledColor:`${s.palette.mode==="light"?s.palette.grey[100]:s.palette.grey[600]}`},[`&.${d.checked} + .${d.track}`]:{opacity:.5},[`&.${d.disabled} + .${d.track}`]:{opacity:s.vars?s.vars.opacity.switchTrackDisabled:`${s.palette.mode==="light"?.12:.2}`},[`& .${d.input}`]:{left:"-100%",width:"300%"}}),({theme:s})=>({"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette.action.activeChannel} / ${s.vars.palette.action.hoverOpacity})`:F.alpha(s.palette.action.active,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(s.palette).filter(([,a])=>a.main&&a.light).map(([a])=>({props:{color:a},style:{[`&.${d.checked}`]:{color:(s.vars||s).palette[a].main,"&:hover":{backgroundColor:s.vars?`rgba(${s.vars.palette[a].mainChannel} / ${s.vars.palette.action.hoverOpacity})`:F.alpha(s.palette[a].main,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${d.disabled}`]:{color:s.vars?s.vars.palette.Switch[`${a}DisabledColor`]:`${s.palette.mode==="light"?F.lighten(s.palette[a].main,.62):F.darken(s.palette[a].main,.55)}`}},[`&.${d.checked} + .${d.track}`]:{backgroundColor:(s.vars||s).palette[a].main}}}))]})),Je=q("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(s,a)=>a.track})(({theme:s})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:s.transitions.create(["opacity","background-color"],{duration:s.transitions.duration.shortest}),backgroundColor:s.vars?s.vars.palette.common.onBackground:`${s.palette.mode==="light"?s.palette.common.black:s.palette.common.white}`,opacity:s.vars?s.vars.opacity.switchTrack:`${s.palette.mode==="light"?.38:.3}`})),Ve=q("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(s,a)=>a.thumb})(({theme:s})=>({boxShadow:(s.vars||s).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Ze=n.forwardRef(function(a,i){const g=Re({props:a,name:"MuiSwitch"}),{className:k,color:u="primary",edge:w=!1,size:C="medium",sx:x}=g,D=Ee(g,Le),h=B({},g,{color:u,edge:w,size:C}),c=Ue(h),m=e.jsx(Ve,{className:c.thumb,ownerState:h});return e.jsxs(He,{className:We(c.root,k),sx:x,ownerState:h,children:[e.jsx(Ge,B({type:"checkbox",icon:m,checkedIcon:m,ref:i,ownerState:h},D,{classes:B({},c,{root:c.switchBase})})),e.jsx(Je,{className:c.track,ownerState:h})]})});var R={},be;function Xe(){if(be)return R;be=1;var s=Q();Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0;var a=s(te()),i=ee();return R.default=(0,a.default)((0,i.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),R}var Ke=Xe();const Ye=se(Ke);var E={},je;function Qe(){if(je)return E;je=1;var s=Q();Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var a=s(te()),i=ee();return E.default=(0,a.default)((0,i.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2m6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5z"}),"NotificationsNone"),E}var es=Qe();const ss=se(es);var W={},ve;function ts(){if(ve)return W;ve=1;var s=Q();Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var a=s(te()),i=ee();return W.default=(0,a.default)([(0,i.jsx)("path",{d:"m21 5-9-4-9 4v6c0 5.55 3.84 10.74 9 12 2.3-.56 4.33-1.9 5.88-3.71l-3.12-3.12c-1.94 1.29-4.58 1.07-6.29-.64-1.95-1.95-1.95-5.12 0-7.07 1.95-1.95 5.12-1.95 7.07 0 1.71 1.71 1.92 4.35.64 6.29l2.9 2.9C20.29 15.69 21 13.38 21 11z"},"0"),(0,i.jsx)("circle",{cx:"12",cy:"12",r:"3"},"1")],"Policy"),W}var as=ts();const rs=se(as),os=[{key:"account",icon:e.jsx(Me,{sx:{fontSize:28}}),title:"Account",subtitle:"Settings related to your personal information and account credentials"},{key:"notifications",icon:e.jsx(ss,{sx:{fontSize:28}}),title:"Notifications",subtitle:"All settings related to notifications"},{key:"workspace",icon:e.jsx(Te,{sx:{fontSize:28}}),title:"Workspace",subtitle:"Manage your workspace settings and preferences"},{key:"privacy",icon:e.jsx(rs,{sx:{fontSize:28}}),title:"Privacy policy",subtitle:"All settings related to privacy"}],we=[{label:"Pause notification",key:"pause"},{label:"In app",key:"inapp"},{label:"Email",key:"email"},{label:"SMS",key:"sms"},{label:"WhatsApp",key:"whatsapp"}],ns=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Paris","Europe/Berlin","Asia/Tokyo","Asia/Shanghai","Australia/Sydney"],is=["en-US","en-GB","es-ES","fr-FR","de-DE","it-IT","pt-BR","ja-JP","zh-CN","ko-KR"],ls=()=>{const s=JSON.parse(localStorage.getItem("user")||"{}"),[a,i]=n.useState("account"),[g,k]=n.useState({pause:!1,inapp:!0,email:!0,sms:!0,whatsapp:!0}),[u,w]=n.useState(null),[C,x]=n.useState(!1),[D,h]=n.useState(""),[c,m]=n.useState(null),[L,U]=n.useState(""),[H,ae]=n.useState(!1),[ye,N]=n.useState(!1),[y,re]=n.useState(!1),[oe,b]=n.useState(""),[ne,I]=n.useState(""),[M,G]=n.useState(""),[j,J]=n.useState(""),[T,V]=n.useState(""),[Se,ie]=n.useState(!1),[p,P]=n.useState(null),[Z,_]=n.useState(!0),[X,z]=n.useState("");n.useEffect(()=>{if(a!=="account")return;x(!0),h(""),O("http://localhost:3000/api/users/me").then(async l=>{if(!l.ok)throw new Error("Failed to fetch profile");const f=await l.json();w(f.data.user)}).catch(()=>h("Failed to load profile")).finally(()=>x(!1))},[a]),n.useEffect(()=>{a==="workspace"&&(_(!0),z(""),_e().then(t=>{P(t)}).catch(()=>z("Failed to load workspace settings")).finally(()=>_(!1)))},[a]);const ke=(t,l)=>{m(t),U(l||"")},Ce=async()=>{if(c){ae(!0);try{const t="http://localhost:3000";if(!(await O(`${t}/api/users/me`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[c]:L})})).ok)throw new Error("Failed to update");m(null),U(""),x(!0),h("");const K=await(await O(`${t}/api/users/me`)).json();w(K.data.user)}catch{}finally{ae(!1),x(!1)}}},Pe=async()=>{if(!M.trim()||!j.trim()||!T.trim()){b("All fields are required");return}if(j!==T){b("New passwords do not match");return}if(j.length<8){b("New password must be at least 8 characters long");return}if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/.test(j)){b("Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character");return}re(!0),b(""),I("");try{const f=await O("http://localhost:3000/api/users/me/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:M.trim(),newPassword:j.trim()})});if(!f.ok){const K=await f.json();throw new Error(K.error||"Failed to change password")}I("Password changed successfully!"),G(""),J(""),V(""),setTimeout(()=>{N(!1),I("")},2e3)}catch(l){b(l instanceof Error?l.message:"Failed to change password")}finally{re(!1)}},ze=async t=>{_(!0),z("");try{p&&(await Fe(p.id,{name:t.name,timezone:t.timezone,locale:t.locale}),P(t),z("Workspace settings updated successfully!"))}catch(l){z(l instanceof Error?l.message:"Failed to update workspace")}finally{_(!1)}};return e.jsxs(o,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#f8f9fa"},children:[e.jsx(o,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(ce,{userRole:s.role,currentTab:"settings",onSignOut:le})}),e.jsx(Ie,{open:Se,onClose:()=>ie(!1),PaperProps:{sx:{width:240}},children:e.jsx(ce,{userRole:s.role,currentTab:"settings",onSignOut:le,isDrawer:!0})}),e.jsxs(o,{sx:{flex:1,ml:{xs:0,md:"220px"},display:"flex",flexDirection:"column",minHeight:"100vh",bgcolor:"#f8f9fa"},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:[e.jsx(r,{variant:"h5",sx:{fontWeight:700,color:"#222"},children:"Settings"}),e.jsx(v,{variant:"outlined",color:"primary",onClick:()=>ie(!0),children:e.jsx(Ye,{})})]}),e.jsxs(o,{sx:{flex:1,display:"flex",flexDirection:{xs:"column",md:"row"},minHeight:"calc(100vh - 64px)",bgcolor:"#f8f9fa"},children:[e.jsx(o,{sx:{width:{xs:"100%",md:320},bgcolor:"#fff",borderRight:{xs:"none",md:"1px solid #e0e0e0"},py:4,px:0,display:{xs:"none",md:"flex"},flexDirection:"column",minHeight:"100%"},children:os.map(t=>e.jsxs(o,{sx:{display:"flex",alignItems:"flex-start",gap:2,px:4,py:2.5,cursor:"pointer",bgcolor:a===t.key?"#E8ECF2":"transparent",borderRight:a===t.key?"4px solid #2950DA":"4px solid transparent",mb:.5,borderRadius:0,transition:"background 0.2s",minHeight:72},onClick:()=>i(t.key),children:[e.jsx(o,{sx:{color:a===t.key?"#2950DA":"#222",mt:.5},children:t.icon}),e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:800,fontSize:19,color:a===t.key?"#2950DA":"#222",mb:.2},children:t.title}),e.jsx(r,{sx:{color:"#6b7280",fontWeight:400,fontSize:14},children:t.subtitle})]})]},t.key))}),e.jsxs(o,{sx:{flex:1,p:{xs:2,md:6},bgcolor:"#f7f8fa",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",minHeight:"100vh"},children:[a==="notifications"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Notifications"}),e.jsx(Y,{elevation:0,sx:{width:{xs:"100%",sm:500},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:we.map((t,l)=>e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:l===we.length-1?0:2},children:[e.jsx(r,{sx:{fontWeight:500,fontSize:18,color:"#222"},children:t.label}),e.jsx(Ze,{checked:g[t.key],onChange:()=>k(f=>({...f,[t.key]:!f[t.key]})),color:"success"})]},t.key))})]}),a==="account"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Account"}),e.jsx(Y,{elevation:0,sx:{width:{xs:"100%",sm:500},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:C?e.jsx(r,{children:"Loading..."}):D?e.jsx(r,{color:"error",children:D}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Legal name"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:(u==null?void 0:u.name)||"N/A"})]}),e.jsx(r,{sx:{color:"#2950DA",fontWeight:700,fontSize:15,cursor:"pointer"},onClick:()=>ke("name",(u==null?void 0:u.name)||""),children:"Edit"})]}),e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Email address"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:(u==null?void 0:u.email)||"N/A"})]})}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:2},children:[e.jsxs(o,{children:[e.jsx(r,{sx:{fontWeight:600,fontSize:16,color:"#222"},children:"Password"}),e.jsx(r,{sx:{color:"#888",fontWeight:400,fontSize:15},children:"••••••••"})]}),e.jsx(v,{variant:"outlined",color:"primary",onClick:()=>{N(!0),b(""),I(""),G(""),J(""),V("")},children:"Change Password"})]})]})}),e.jsxs(ue,{open:!!c,onClose:()=>m(null),children:[e.jsxs(pe,{children:["Edit"," ",c==="name"?"Legal name":c==="email"?"Email address":c==="address"?"Address":c==="phone"?"Phone number":"Government ID"]}),e.jsx(he,{children:e.jsx($,{autoFocus:!0,margin:"dense",label:c==="name"?"Legal name":c==="email"?"Email address":c==="address"?"Address":c==="phone"?"Phone number":"Government ID",type:"text",fullWidth:!0,value:L,onChange:t=>U(t.target.value)})}),e.jsxs(xe,{children:[e.jsx(v,{onClick:()=>m(null),disabled:H,children:"Cancel"}),e.jsx(v,{onClick:Ce,variant:"contained",color:"primary",disabled:H||!L.trim(),children:H?"Saving...":"Save"})]})]})]}),a==="workspace"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:4,alignSelf:"flex-start"},children:"Workspace Settings"}),e.jsx(Y,{elevation:0,sx:{width:{xs:"100%",sm:600},borderRadius:4,p:4,bgcolor:"#fff",boxShadow:"0 2px 8px 0 rgba(44,62,80,0.04)"},children:Z?e.jsx(o,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(Ne,{})}):X?e.jsx(Be,{severity:X.includes("successfully")?"success":"error",sx:{mb:3},children:X}):p?e.jsx(o,{children:e.jsxs(A,{container:!0,spacing:3,children:[e.jsx(A,{item:!0,xs:12,sm:6,children:e.jsx($,{fullWidth:!0,label:"Workspace Name",value:p.name,onChange:t=>{const l={...p,name:t.target.value};P(l)},sx:{mb:2}})}),e.jsx(A,{item:!0,xs:12,sm:6,children:e.jsxs(fe,{fullWidth:!0,sx:{mb:2},children:[e.jsx(ge,{children:"Timezone"}),e.jsx(me,{value:p.timezone,label:"Timezone",onChange:t=>{const l={...p,timezone:t.target.value};P(l)},children:ns.map(t=>e.jsx(de,{value:t,children:t},t))})]})}),e.jsx(A,{item:!0,xs:12,sm:6,children:e.jsxs(fe,{fullWidth:!0,sx:{mb:2},children:[e.jsx(ge,{children:"Locale"}),e.jsx(me,{value:p.locale,label:"Locale",onChange:t=>{const l={...p,locale:t.target.value};P(l)},children:is.map(t=>e.jsx(de,{value:t,children:t},t))})]})}),e.jsx(A,{item:!0,xs:12,children:e.jsx(v,{variant:"contained",color:"primary",onClick:()=>ze(p),disabled:Z,sx:{mt:2},children:Z?"Saving...":"Save Changes"})})]})}):e.jsx(r,{color:"error",children:"No workspace data available"})})]}),a==="privacy"&&e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222",mb:2},children:"Privacy Policy"})]})]})]}),e.jsxs(ue,{open:ye,onClose:()=>N(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(pe,{children:"Change Password"}),e.jsxs(he,{children:[ne?e.jsx(r,{color:"success.main",sx:{mb:2},children:ne}):null,oe?e.jsx(r,{color:"error.main",sx:{mb:2},children:oe}):null,e.jsxs(o,{sx:{bgcolor:"#f8f9fa",p:2,borderRadius:1,mb:2,border:"1px solid #e9ecef"},children:[e.jsx(r,{sx:{fontWeight:600,fontSize:14,color:"#495057",mb:1},children:"Password Requirements:"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• Minimum 8 characters"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 uppercase letter (A-Z)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 lowercase letter (a-z)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 number (0-9)"}),e.jsx(r,{sx:{fontSize:13,color:"#6c757d"},children:"• At least 1 special character (@$!%*?&)"})]})]}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx($,{label:"Current Password",type:"password",fullWidth:!0,value:M,onChange:t=>G(t.target.value),disabled:y}),e.jsx($,{label:"New Password",type:"password",fullWidth:!0,value:j,onChange:t=>J(t.target.value),disabled:y,helperText:"Minimum 8 characters, 1 uppercase, 1 lowercase, 1 number, and 1 special character"}),e.jsx($,{label:"Confirm New Password",type:"password",fullWidth:!0,value:T,onChange:t=>V(t.target.value),disabled:y})]})]}),e.jsxs(xe,{children:[e.jsx(v,{onClick:()=>N(!1),disabled:y,children:"Cancel"}),e.jsx(v,{variant:"contained",color:"primary",disabled:y||!M.trim()||!j.trim()||!T.trim(),onClick:Pe,children:y?"Changing Password...":"Change Password"})]})]})]})},ws=Object.freeze(Object.defineProperty({__proto__:null,default:ls},Symbol.toStringTag,{value:"Module"}));export{Ye as M,ls as S,ws as a};
