import{r,R as X,j as e,B as n,T as i,n as Y}from"./index-fCfVdIb_.js";import{S as _}from"./Search-BC-Ofllg.js";import{M as q}from"./MoreVert-B_mpF_j7.js";import{T as G,a as K,b as Q,c as p,d as t,e as Z,C as $,f as ee,P as se}from"./CheckBoxOutlineBlank-CqqmU7mz.js";import{c as D,D as te,C as ae}from"./AdminSidebar-BBv4d0ET.js";import{g as A,a as re,c as T}from"./workspaceService-De8V3rWU.js";import{T as ne}from"./TextField-wsB3RUt6.js";import{I as ie}from"./InputAdornment-B2lj4qzo.js";import{P as oe}from"./Paper-CKbGO1De.js";import{C as le}from"./Checkbox-D8KOIQnX.js";import{I as ce}from"./IconButton-BPkErCXm.js";import{D as de,a as xe,b as he,c as me}from"./DialogTitle-iJWlEKpy.js";import{B as u}from"./Button-ByqV_kVW.js";import"./createSvgIcon-DwuZuMzk.js";import"./createSvgIcon-BSKynw4V.js";import"./useControlled-2dS18CDz.js";import"./Menu-Bci3i90i.js";import"./resolveComponentProps-D3En-UR9.js";import"./HomeOutlined-Pe4WBg8G.js";import"./session-BuX4dWJT.js";import"./useSlot-DvK8vWAK.js";import"./Divider-Bxrz04ol.js";import"./SwitchBase-D6mSDcfl.js";const Pe=()=>{const[c,k]=r.useState(""),[v,E]=r.useState([]),[f,W]=r.useState(1),[g,z]=r.useState([]),[U,S]=r.useState(!0),[b,C]=r.useState(""),[o,d]=r.useState(null),[O,x]=r.useState(!1),[l,B]=r.useState(""),[M,P]=r.useState(0),R=async s=>{try{if(!l)throw new Error("Workspace not loaded");await T(l,s,"ACTIVE"),await h(),x(!1),d(null)}catch{alert("Failed to activate user.")}},N=async s=>{try{if(!l)throw new Error("Workspace not loaded");await T(l,s,"DEACTIVATED"),await h(),x(!1),d(null)}catch{alert("Failed to deactivate user.")}},h=async()=>{S(!0),C("");try{if(!l){const m=await A();B(m.id)}const s=l||(await A()).id,a=await re(s,{role:"ADMIN",page:f,limit:10,search:c||void 0});z(a.data),P(a.pagination.total)}catch{C("Failed to load admin users")}finally{S(!1)}};r.useEffect(()=>{h();const s=setInterval(h,3e4);return()=>clearInterval(s)},[]),r.useEffect(()=>{h()},[f,c]);const L=s=>{E(a=>a.includes(s)?a.filter(m=>m!==s):[...a,s])},V=async s=>{try{const a=g.find(m=>m.id===s);if(a)d(a),x(!0);else throw new Error("User not found")}catch{d(null),x(!1),alert("Failed to load user details")}},w=()=>{x(!1),d(null)},j=()=>{Y()},F=g.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())),J=10,I=F,[H,y]=X.useState(!1);return e.jsxs(n,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#f7f8fa"},children:[e.jsx(n,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(D,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:j})}),e.jsx(te,{open:H,onClose:()=>y(!1),PaperProps:{sx:{width:240}},children:e.jsx(D,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:j,isDrawer:!0})}),e.jsxs(n,{sx:{flex:1,display:"flex",flexDirection:"column",ml:{xs:0,md:"220px"}},children:[e.jsx(ae,{user:JSON.parse(localStorage.getItem("user")||"{}"),onSignOut:j,onToggleSidebar:()=>y(!0)}),e.jsx(n,{sx:{flex:1,px:{xs:2,md:6},py:{xs:2,md:4}},children:e.jsxs(n,{sx:{maxWidth:1200,mx:"auto"},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:{xs:"flex-start",md:"space-between"},alignItems:{xs:"stretch",md:"center"},mb:2,flexDirection:{xs:"column",md:"row"},gap:{xs:1.5,md:0}},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(i,{variant:"h4",sx:{fontWeight:700,color:"#222"},children:"Admin Users"}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(n,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#2950DA",opacity:.7}}),e.jsx(i,{sx:{color:"#666",fontSize:12},children:"Live data"})]})]}),e.jsx(ne,{placeholder:"Search admin users...",size:"small",InputProps:{startAdornment:e.jsx(ie,{position:"start",children:e.jsx(_,{sx:{color:"#bdbdbd"}})}),sx:{borderRadius:3,bgcolor:"#fff",width:{xs:"100%",sm:320},fontSize:18}},value:c,onChange:s=>k(s.target.value)})]}),e.jsxs(oe,{elevation:0,sx:{borderRadius:3,p:3,mt:2},children:[e.jsx(n,{sx:{display:"flex",alignItems:"center",mb:2},children:e.jsxs(i,{sx:{color:"#888",fontWeight:600,fontSize:16,ml:"auto"},children:["Date : ",e.jsx("span",{style:{color:"#222"},children:"All"})]})}),e.jsx(G,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(K,{size:"small",children:[e.jsx(Q,{children:e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User ID"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Name"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Type"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"Status"}),e.jsx(t,{align:"right"})]})}),e.jsx(Z,{children:U?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(i,{children:"Loading admin users..."})})}):b?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4,color:"error.main"},children:e.jsx(i,{children:b})})}):I.length===0?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(i,{children:"No admin users found"})})}):I.map((s,a)=>e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox",children:e.jsx(le,{checked:v.includes(a),onChange:()=>L(a),icon:e.jsx(ee,{}),checkedIcon:e.jsx($,{sx:{color:"#2950DA"}})})}),e.jsx(t,{sx:{fontWeight:700,fontSize:{xs:12,md:16},whiteSpace:"nowrap"},children:s.id}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.name}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.role}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.status==="ACTIVE"?"Active":"Inactive"}),e.jsx(t,{align:"right",children:e.jsx(ce,{onClick:()=>V(s.id),children:e.jsx(q,{})})})]},s.id))})]})}),e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:e.jsx(se,{count:Math.max(1,Math.ceil((M||0)/J)),page:f,onChange:(s,a)=>W(a),color:"primary",shape:"rounded",size:"large"})})]})]})})]}),e.jsxs(de,{open:O,onClose:w,maxWidth:"sm",fullWidth:!0,children:[e.jsx(xe,{children:"User Details"}),e.jsx(he,{children:o?e.jsxs(n,{children:[e.jsxs(i,{children:[e.jsx("b",{children:"ID:"})," ",o.id]}),e.jsxs(i,{children:[e.jsx("b",{children:"Name:"})," ",o.name]}),e.jsxs(i,{children:[e.jsx("b",{children:"Email:"})," ",o.email]}),e.jsxs(i,{children:[e.jsx("b",{children:"User Type:"})," ",o.role]}),e.jsxs(i,{children:[e.jsx("b",{children:"Active:"})," ",o.status==="ACTIVE"?"Yes":"No"]})]}):null}),e.jsxs(me,{children:[e.jsx(u,{onClick:w,children:"Close"}),o&&e.jsx(e.Fragment,{children:o.status==="ACTIVE"?e.jsx(u,{onClick:()=>N(o.id),color:"warning",children:"Deactivate"}):e.jsx(u,{onClick:()=>R(o.id),color:"success",children:"Activate"})})]})]})]})};export{Pe as default};
