import{f as A,E as C,h as R,i as q,r as p,k as E,l as T,j as e,B as l,T as b}from"./index-fCfVdIb_.js";import{V as _,a as D}from"./Visibility-D4vt_g5I.js";import{r as L}from"./createSvgIcon-DwuZuMzk.js";import{A as I}from"./Alert-Ch7i31mG.js";import{T as S}from"./TextField-wsB3RUt6.js";import{I as M}from"./InputAdornment-B2lj4qzo.js";import{I as m}from"./IconButton-BPkErCXm.js";import{B as v}from"./Button-ByqV_kVW.js";import"./createSvgIcon-BSKynw4V.js";import"./useControlled-2dS18CDz.js";import"./useSlot-DvK8vWAK.js";import"./resolveComponentProps-D3En-UR9.js";import"./Paper-CKbGO1De.js";import"./Menu-Bci3i90i.js";var h={},W;function N(){if(W)return h;W=1;var g=A();Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0,w(C());var y=g(L()),c=R();function x(t){if(typeof WeakMap!="function")return null;var d=new WeakMap,s=new WeakMap;return(x=function(n){return n?s:d})(t)}function w(t,d){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var s=x(d);if(s&&s.has(t))return s.get(t);var n={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var i=j?Object.getOwnPropertyDescriptor(t,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=t[a]}return n.default=t,s&&s.set(t,n),n}return h.default=(0,y.default)((0,c.jsx)("path",{d:"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"}),"Apple"),h}var z=N();const F=q(z),B=()=>{const[g,y]=p.useState(!1),[c,x]=p.useState({email:"",password:""}),[w,t]=p.useState(""),[d,s]=p.useState(""),[n,j]=p.useState(!1),a=E(),i=T();p.useEffect(()=>{var u;const o=(u=i.state)==null?void 0:u.message;o&&s(o)},[i]);const k=o=>{x({...c,[o.target.name]:o.target.value})},P=async o=>{o.preventDefault(),t(""),j(!0);try{const f=await fetch("http://localhost:3000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),r=await f.json();if(!f.ok)throw f.status===403&&r.error&&r.error.includes("Email not verified")?new Error("Your email is not verified. Please check your inbox and verify your account before logging in."):f.status===401&&r.error&&r.error.includes("Invalid email or password")?new Error("Wrong password. Please check your password and try again."):f.status===423&&r.error&&r.error.includes("Account is temporarily locked")?new Error("Account is temporarily locked due to too many failed attempts. Please wait 15 minutes before trying again."):new Error(r.error||"Login failed");localStorage.setItem("token",r.data.accessToken),localStorage.setItem("user",JSON.stringify(r.data.user)),r.data.refreshToken&&localStorage.setItem("refreshToken",r.data.refreshToken),r.data.workspaceId&&localStorage.setItem("workspaceId",r.data.workspaceId),r.data.workspaceName&&localStorage.setItem("workspaceName",r.data.workspaceName),a("/",{replace:!0})}catch(u){t(u instanceof Error?u.message:"Login failed")}finally{j(!1)}},O=()=>{const o="http://localhost:3000";window.location.href=`${o}/api/auth/google`};return e.jsx(l,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#fff",justifyContent:"center",alignItems:"center"},children:e.jsx(l,{sx:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",px:4,maxWidth:480},children:e.jsxs(l,{component:"form",onSubmit:P,sx:{width:"100%",maxWidth:370},children:[e.jsx(b,{variant:"h5",sx:{fontWeight:800,mb:4,color:"#222"},children:"Log in"}),d&&e.jsx(I,{severity:"success",sx:{mb:2},children:d}),w&&e.jsx(I,{severity:"error",sx:{mb:2},children:w}),e.jsx(b,{sx:{fontWeight:700,fontSize:16,mb:1,color:"#222"},children:"Email"}),e.jsx(S,{fullWidth:!0,name:"email",type:"email",placeholder:"Your email",variant:"outlined",value:c.email,onChange:k,required:!0,sx:{mb:2,borderRadius:2,"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(b,{sx:{fontWeight:700,fontSize:16,mb:1,color:"#222"},children:"Password"}),e.jsx(S,{fullWidth:!0,name:"password",placeholder:"Your password",variant:"outlined",type:g?"text":"password",value:c.password,onChange:k,required:!0,sx:{mb:1,borderRadius:2,"& .MuiOutlinedInput-root":{borderRadius:2}},InputProps:{endAdornment:e.jsx(M,{position:"end",children:e.jsx(m,{onClick:()=>y(o=>!o),edge:"end",children:g?e.jsx(_,{}):e.jsx(D,{})})})}}),e.jsx(l,{sx:{display:"flex",justifyContent:"flex-end",mb:2},children:e.jsx(v,{sx:{color:"#526794",fontWeight:600,fontSize:15,textTransform:"none",p:0,minWidth:0},onClick:()=>a("/forgot-password"),children:"Forgot Password?"})}),e.jsx(v,{type:"submit",variant:"contained",fullWidth:!0,disabled:n,sx:{bgcolor:"#526794",color:"#fff",fontWeight:700,fontSize:18,borderRadius:2,py:1.5,mb:3,boxShadow:"none",textTransform:"none","&:hover":{bgcolor:"#526794"}},children:n?"Logging in...":"Log in"}),e.jsxs(l,{sx:{display:"flex",justifyContent:"center",gap:2,mb:3},children:[e.jsx(m,{sx:{p:1.2},onClick:O,children:e.jsx(l,{component:"img",src:"https://th.bing.com/th?q=Google+Login+Logo.png&w=120&h=120&c=1&rs=1&qlt=70&o=7&cb=1&dpr=1.5&pid=InlineBlock&rm=3&mkt=en-IN&cc=IN&setlang=en&adlt=moderate&t=1&mw=247",alt:"Google",sx:{width:28,height:28,objectFit:"contain"}})}),e.jsx(m,{sx:{p:1.2},children:e.jsx(F,{sx:{fontSize:32,color:"#222"}})}),e.jsx(m,{sx:{p:1.2},children:e.jsx(l,{component:"img",src:"https://th.bing.com/th/id/OIP.swFnAmrkP4rAX8Od0GNpnwHaHw?pid=ImgDet&w=178&h=186&c=7&dpr=1.5",alt:"Twitter",sx:{width:28,height:28,objectFit:"contain"}})}),e.jsx(m,{sx:{p:1.2,bgcolor:"#fff"}})]}),e.jsxs(b,{sx:{textAlign:"center",color:"#444",fontWeight:500,fontSize:16,mt:1},children:["Don't have an account?"," ",e.jsx(v,{sx:{color:"#1a237e",fontWeight:700,fontSize:16,textTransform:"none",p:0,minWidth:0},onClick:()=>a("/register"),children:"Register"})]})]})})})},oe=()=>e.jsx(B,{});export{oe as default};
