import{r as n,R as X,j as e,B as o,T as r,n as Y}from"./index-CWeEywqT.js";import{S as _}from"./Search-CBDeRSyq.js";import{T as q,a as G,b as K,c as p,d as t,e as Q,C as Z,f as $,P as ee}from"./CheckBoxOutlineBlank-KQO3xDf0.js";import{M as se}from"./MoreVert-B6Q469tj.js";import{A as y,D as te}from"./AdminSidebar-C2x2nuER.js";import{g as A,a as ae,c as D}from"./workspaceService-CU4ueMZD.js";import{T as ne}from"./TextField-DHD0qB-R.js";import{I as re}from"./InputAdornment-BPbB3qxx.js";import{P as ie}from"./Paper-sTiXuyWJ.js";import{C as oe}from"./Checkbox-ChcOwzum.js";import{I as le}from"./IconButton-CidfSyUT.js";import{D as ce,a as de,b as xe,c as he}from"./DialogTitle-CTHzxGHz.js";import{B as j}from"./Button-DHwWXDFU.js";import"./createSvgIcon-Cam1noSb.js";import"./createSvgIcon-X_frCy3j.js";import"./useControlled-CI1ho5Il.js";import"./Menu-BzuyABrT.js";import"./resolveComponentProps-B4TZS91P.js";import"./useMediaQuery-BY7LMYJB.js";import"./getThemeProps-C0HuVOHX.js";import"./Divider-tWgJtwah.js";import"./Avatar-rsmS1bhS.js";import"./useSlot-DWjzsRK2.js";import"./session-Cma3K_fR.js";import"./SwitchBase-DpchkFVh.js";const Oe=()=>{const[c,T]=n.useState(""),[k,E]=n.useState([]),[f,v]=n.useState(1),[u,W]=n.useState([]),[z,g]=n.useState(!0),[S,b]=n.useState(""),[i,d]=n.useState(null),[U,x]=n.useState(!1),[l,B]=n.useState(""),[M,P]=n.useState(0),R=async s=>{try{if(!l)throw new Error("Workspace not loaded");await D(l,s,"ACTIVE"),await h(),x(!1),d(null)}catch{alert("Failed to activate user.")}},O=async s=>{try{if(!l)throw new Error("Workspace not loaded");await D(l,s,"DEACTIVATED"),await h(),x(!1),d(null)}catch{alert("Failed to deactivate user.")}},h=async()=>{g(!0),b("");try{if(!l){const m=await A();B(m.id)}const s=l||(await A()).id,a=await ae(s,{role:"ADMIN",page:f,limit:10,search:c||void 0});W(a.data),P(a.pagination.total)}catch{b("Failed to load admin users")}finally{g(!1)}};n.useEffect(()=>{h();const s=setInterval(h,3e4);return()=>clearInterval(s)},[]),n.useEffect(()=>{h()},[f,c]);const L=s=>{E(a=>a.includes(s)?a.filter(m=>m!==s):[...a,s])},N=async s=>{try{const a=u.find(m=>m.id===s);if(a)d(a),x(!0);else throw new Error("User not found")}catch{d(null),x(!1),alert("Failed to load user details")}},w=()=>{x(!1),d(null)},C=()=>{Y()},V=u.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())),F=10,I=V,[H,J]=X.useState(!1);return e.jsxs(o,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#f7f8fa"},children:[e.jsx(o,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(y,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:C})}),e.jsx(te,{open:H,onClose:()=>J(!1),PaperProps:{sx:{width:240}},children:e.jsx(y,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:C,isDrawer:!0})}),e.jsxs(o,{sx:{flex:1,display:"flex",flexDirection:"column",ml:{xs:0,md:"220px"}},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,bgcolor:"#fff",boxShadow:1},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(r,{variant:"h4",sx:{fontWeight:700,color:"#222"},children:"Admin Users"}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(o,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#2950DA",opacity:.7}}),e.jsx(r,{sx:{color:"#666",fontSize:12},children:"Live data"})]})]}),e.jsx(ne,{placeholder:"Search admin users...",size:"small",InputProps:{startAdornment:e.jsx(re,{position:"start",children:e.jsx(_,{sx:{color:"#bdbdbd"}})}),sx:{borderRadius:3,bgcolor:"#fff",width:{xs:"100%",sm:320},fontSize:18}},value:c,onChange:s=>T(s.target.value)})]}),e.jsxs(ie,{elevation:0,sx:{borderRadius:3,p:3,mt:2},children:[e.jsx(o,{sx:{display:"flex",alignItems:"center",mb:2},children:e.jsxs(r,{sx:{color:"#888",fontWeight:600,fontSize:16,ml:"auto"},children:["Date : ",e.jsx("span",{style:{color:"#222"},children:"All"})]})}),e.jsx(q,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(G,{size:"small",children:[e.jsx(K,{children:e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User ID"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Name"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Type"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"Status"}),e.jsx(t,{align:"right"})]})}),e.jsx(Q,{children:z?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(r,{children:"Loading admin users..."})})}):S?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4,color:"error.main"},children:e.jsx(r,{children:S})})}):I.length===0?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(r,{children:"No admin users found"})})}):I.map((s,a)=>e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox",children:e.jsx(oe,{checked:k.includes(a),onChange:()=>L(a),icon:e.jsx($,{}),checkedIcon:e.jsx(Z,{sx:{color:"#2950DA"}})})}),e.jsx(t,{sx:{fontWeight:700,fontSize:{xs:12,md:16},whiteSpace:"nowrap"},children:s.id}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.name}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.role}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.status==="ACTIVE"?"Active":"Inactive"}),e.jsx(t,{align:"right",children:e.jsx(le,{onClick:()=>N(s.id),children:e.jsx(se,{})})})]},s.id))})]})}),e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:e.jsx(ee,{count:Math.max(1,Math.ceil((M||0)/F)),page:f,onChange:(s,a)=>v(a),color:"primary",shape:"rounded",size:"large"})})]})]}),e.jsxs(ce,{open:U,onClose:w,maxWidth:"sm",fullWidth:!0,children:[e.jsx(de,{children:"User Details"}),e.jsx(xe,{children:i?e.jsxs(o,{children:[e.jsxs(r,{children:[e.jsx("b",{children:"ID:"})," ",i.id]}),e.jsxs(r,{children:[e.jsx("b",{children:"Name:"})," ",i.name]}),e.jsxs(r,{children:[e.jsx("b",{children:"Email:"})," ",i.email]}),e.jsxs(r,{children:[e.jsx("b",{children:"User Type:"})," ",i.role]}),e.jsxs(r,{children:[e.jsx("b",{children:"Active:"})," ",i.status==="ACTIVE"?"Yes":"No"]})]}):null}),e.jsxs(he,{children:[e.jsx(j,{onClick:w,children:"Close"}),i&&e.jsx(e.Fragment,{children:i.status==="ACTIVE"?e.jsx(j,{onClick:()=>O(i.id),color:"warning",children:"Deactivate"}):e.jsx(j,{onClick:()=>R(i.id),color:"success",children:"Activate"})})]})]})]})};export{Oe as default};
