import{r as n,R as X,j as e,B as i,T as o,n as Y}from"./index-CVFjBazT.js";import{S as _}from"./Search-BrjMgAqD.js";import{T as q,a as G,b as K,c as p,d as t,e as Q,C as Z,f as $,P as ee}from"./CheckBoxOutlineBlank-Bfw84Wt3.js";import{M as se}from"./MoreVert-B9BrOwKH.js";import{A as D,D as te}from"./AdminSidebar-CF5Hd0jl.js";import{g as T,a as ae,c as k}from"./workspaceService-CU4ueMZD.js";import{T as ne}from"./TextField-DAm2tQd-.js";import{I as re}from"./InputAdornment-qZMVxQ_8.js";import{P as ie}from"./Paper-BgPd5ujD.js";import{C as oe}from"./Checkbox-Crwo2N3C.js";import{I as le}from"./IconButton-DlSDUMzR.js";import{D as ce,a as de,b as xe,c as he}from"./DialogTitle-Bnyi_i4z.js";import{B as u}from"./Button-z02TSlFu.js";import"./createSvgIcon-Cp9E4wFO.js";import"./createSvgIcon-BfE82ItR.js";import"./useControlled-DlQ_-1kq.js";import"./Menu-OLBZc4RG.js";import"./resolveComponentProps-CTLr-dSE.js";import"./useMediaQuery-DBMDA1h7.js";import"./getThemeProps-DEf1ea3E.js";import"./Divider-C8Z4Hsj1.js";import"./Avatar-CRmYJ6bI.js";import"./useSlot-CInQRO00.js";import"./session-Cma3K_fR.js";import"./SwitchBase-DR-Bl87B.js";const Oe=()=>{const[c,E]=n.useState(""),[v,W]=n.useState([]),[f,z]=n.useState(1),[g,U]=n.useState([]),[R,S]=n.useState(!0),[b,w]=n.useState(""),[r,d]=n.useState(null),[B,x]=n.useState(!1),[l,P]=n.useState(""),[j,M]=n.useState(0),O=async s=>{try{if(!l)throw new Error("Workspace not loaded");await k(l,s,"ACTIVE"),await h(),x(!1),d(null)}catch{alert("Failed to activate user.")}},F=async s=>{try{if(!l)throw new Error("Workspace not loaded");await k(l,s,"DEACTIVATED"),await h(),x(!1),d(null)}catch{alert("Failed to deactivate user.")}},h=async()=>{S(!0),w("");try{if(!l){const m=await T();P(m.id)}const s=l||(await T()).id,a=await ae(s,{role:"ADMIN",page:f,limit:10,search:c||void 0});U(a.data),M(a.pagination.total)}catch{w("Failed to load admin users")}finally{S(!1)}};n.useEffect(()=>{h();const s=setInterval(h,3e4);return()=>clearInterval(s)},[]),n.useEffect(()=>{h()},[f,c]);const L=s=>{W(a=>a.includes(s)?a.filter(m=>m!==s):[...a,s])},N=async s=>{try{const a=g.find(m=>m.id===s);if(a)d(a),x(!0);else throw new Error("User not found")}catch{d(null),x(!1),alert("Failed to load user details")}},C=()=>{x(!1),d(null)},I=()=>{Y()},V=g.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())),y=10,A=V,[H,J]=X.useState(!1);return e.jsxs(i,{sx:{display:"flex",minHeight:"100vh",bgcolor:"#f7f8fa"},children:[e.jsx(i,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(D,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:I})}),e.jsx(te,{open:H,onClose:()=>J(!1),PaperProps:{sx:{width:240}},children:e.jsx(D,{userRole:JSON.parse(localStorage.getItem("user")||"{}").role||"MEMBER",currentTab:"admins",onSignOut:I,isDrawer:!0})}),e.jsxs(i,{sx:{flex:1,display:"flex",flexDirection:"column",ml:{xs:0,md:"220px"},minWidth:0},children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,px:{xs:2,md:6},pt:{xs:2,md:3},fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif'},children:[e.jsx(i,{sx:{display:"flex",alignItems:"flex-start",gap:1},children:e.jsxs(i,{children:[e.jsx(o,{sx:{fontWeight:700,fontSize:{xs:18,md:24},color:"#222"},children:"Admin Users"}),e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:[e.jsx(i,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"#2950DA",opacity:.7}}),e.jsxs(o,{sx:{color:"#666",fontSize:12},children:[j," admins"]})]})]})}),e.jsx(ne,{placeholder:"Search admin users...",size:"small",InputProps:{startAdornment:e.jsx(re,{position:"start",children:e.jsx(_,{sx:{color:"#bdbdbd"}})}),sx:{borderRadius:3,bgcolor:"#fff",width:{xs:220,sm:320},fontSize:16}},value:c,onChange:s=>E(s.target.value)})]}),e.jsxs(ie,{elevation:0,sx:{borderRadius:3,p:{xs:2,md:3},mx:{xs:2,md:6}},children:[e.jsx(q,{sx:{width:"100%",overflowX:"auto"},children:e.jsxs(G,{size:"small",children:[e.jsx(K,{children:e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User ID"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Name"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"User Type"}),e.jsx(t,{sx:{fontWeight:800,fontSize:{xs:14,md:16}},children:"Status"}),e.jsx(t,{align:"right"})]})}),e.jsx(Q,{children:R?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(o,{children:"Loading admin users..."})})}):b?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4,color:"error.main"},children:e.jsx(o,{children:b})})}):A.length===0?e.jsx(p,{children:e.jsx(t,{colSpan:6,sx:{textAlign:"center",py:4},children:e.jsx(o,{children:"No admin users found"})})}):A.map((s,a)=>e.jsxs(p,{children:[e.jsx(t,{padding:"checkbox",children:e.jsx(oe,{checked:v.includes(a),onChange:()=>L(a),icon:e.jsx($,{}),checkedIcon:e.jsx(Z,{sx:{color:"#2950DA"}})})}),e.jsx(t,{sx:{fontWeight:700,fontSize:{xs:12,md:16},whiteSpace:"nowrap"},children:s.id}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.name}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.role}),e.jsx(t,{sx:{fontWeight:600,fontSize:{xs:14,md:16}},children:s.status==="ACTIVE"?"Active":"Inactive"}),e.jsx(t,{align:"right",children:e.jsx(le,{onClick:()=>N(s.id),children:e.jsx(se,{})})})]},s.id))})]})}),j>y&&e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:3},children:e.jsx(ee,{count:Math.ceil((j||0)/y),page:f,onChange:(s,a)=>z(a),color:"primary",shape:"rounded",size:"large"})})]})]}),e.jsxs(ce,{open:B,onClose:C,maxWidth:"sm",fullWidth:!0,children:[e.jsx(de,{children:"User Details"}),e.jsx(xe,{children:r?e.jsxs(i,{children:[e.jsxs(o,{children:[e.jsx("b",{children:"ID:"})," ",r.id]}),e.jsxs(o,{children:[e.jsx("b",{children:"Name:"})," ",r.name]}),e.jsxs(o,{children:[e.jsx("b",{children:"Email:"})," ",r.email]}),e.jsxs(o,{children:[e.jsx("b",{children:"User Type:"})," ",r.role]}),e.jsxs(o,{children:[e.jsx("b",{children:"Active:"})," ",r.status==="ACTIVE"?"Yes":"No"]})]}):null}),e.jsxs(he,{children:[e.jsx(u,{onClick:C,children:"Close"}),r&&e.jsx(e.Fragment,{children:r.status==="ACTIVE"?e.jsx(u,{onClick:()=>F(r.id),color:"warning",children:"Deactivate"}):e.jsx(u,{onClick:()=>O(r.id),color:"success",children:"Activate"})})]})]})]})};export{Oe as default};
